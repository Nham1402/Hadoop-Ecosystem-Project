# Spark Configuration

# Spark master configuration
spark.master                     spark://spark-master:7077
spark.eventLog.enabled           true
spark.eventLog.dir               hdfs://namenode:8020/spark-logs
spark.history.fs.logDirectory    hdfs://namenode:8020/spark-logs

# Serialization
spark.serializer                 org.apache.spark.serializer.KryoSerializer
spark.kryo.unsafe                true
spark.kryoserializer.buffer.max  2047m

# Memory management
spark.executor.memory            2g
spark.executor.cores             2
spark.driver.memory              1g
spark.driver.cores               1
spark.executor.instances         2

# Dynamic allocation
spark.dynamicAllocation.enabled  true
spark.dynamicAllocation.minExecutors    1
spark.dynamicAllocation.maxExecutors    10
spark.dynamicAllocation.initialExecutors 2

# Shuffle service
spark.shuffle.service.enabled    true
spark.sql.adaptive.enabled       true
spark.sql.adaptive.coalescePartitions.enabled true

# Hadoop integration
spark.hadoop.fs.defaultFS        hdfs://namenode:8020
spark.sql.warehouse.dir          hdfs://namenode:8020/spark-warehouse

# Hive integration
spark.sql.catalogImplementation  hive
spark.sql.hive.metastore.version 3.1.3
spark.sql.hive.metastore.jars    /opt/spark/jars/*

# Network
spark.driver.host                0.0.0.0
spark.driver.bindAddress         0.0.0.0

# UI
spark.ui.enabled                 true
spark.ui.port                    4040

# Metrics
spark.metrics.conf               /opt/spark/conf/metrics.properties

# Security
spark.authenticate               false
spark.network.crypto.enabled     false

# Performance tuning
spark.sql.adaptive.advisoryPartitionSizeInBytes  128MB
spark.sql.adaptive.coalescePartitions.minPartitionNum  1
spark.sql.adaptive.skewJoin.enabled  true

# Checkpointing
spark.sql.streaming.checkpointLocation  hdfs://namenode:8020/spark-checkpoints

# Compression
spark.io.compression.codec       snappy
spark.rdd.compress               true

# Garbage collection
spark.executor.extraJavaOptions  -XX:+UseG1GC -XX:+UseStringDeduplication -XX:MaxGCPauseMillis=200
spark.driver.extraJavaOptions    -XX:+UseG1GC -XX:+UseStringDeduplication

# Kubernetes specific (for future K8s deployment)
spark.kubernetes.namespace       hadoop-ecosystem
spark.kubernetes.authenticate.driver.serviceAccountName  spark
spark.kubernetes.container.image.pullPolicy  Always